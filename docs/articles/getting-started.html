<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Get Started with PNADCperiods • PNADCperiods</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get Started with PNADCperiods">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PNADCperiods</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/getting-started.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/download-and-prepare.html">Download and Prepare Data</a></li>
    <li><a class="dropdown-item" href="../articles/applied-examples.html">Applied Examples</a></li>
    <li><a class="dropdown-item" href="../articles/annual-poverty-analysis.html">Annual Poverty Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/complex-survey-design.html">Complex Survey Design</a></li>
    <li><a class="dropdown-item" href="../articles/how-it-works.html">How PNADCperiods Works</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/sidra-mensalization.html">SIDRA Mensalization Guide</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/antrologos/PNADCperiods/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get Started with PNADCperiods</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/antrologos/PNADCperiods/blob/HEAD/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>PNADCperiods</code> package converts Brazil’s quarterly
PNADC (Pesquisa Nacional por Amostra de Domicilios Continua) survey data
into sub-quarterly time series. PNADC quarterly statistics are actually
moving averages of three months, which obscures the true timing of
economic shocks, the actual magnitude of changes, and turning points in
trends.</p>
<p>The package offers <strong>two complementary approaches</strong>:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Microdata mensalization</strong> — Identify which
specific month, fortnight, or week each survey observation refers to,
then calibrate weights for sub-quarterly analysis. Use this for custom
variables, subgroup analysis, or individual-level regressions.</p></li>
<li><p><strong>SIDRA mensalization</strong> — Convert IBGE’s published
rolling quarter aggregate series (86+ indicators) into exact monthly
estimates. No microdata needed — just 3 lines of code.</p></li>
</ol>
<p>For a detailed explanation of the algorithm, see <a href="how-it-works.html">How PNADCperiods Works</a>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"antrologos/PNADCperiods"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://antrologos.github.io/PNADCperiods/">PNADCperiods</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<p><strong>Dependencies:</strong> <code>data.table</code>,
<code>checkmate</code>, and <code>sidrar</code> (for weight calibration
and SIDRA API access).</p>
<hr>
</div>
<div class="section level2">
<h2 id="microdata-mensalization">Microdata Mensalization<a class="anchor" aria-label="anchor" href="#microdata-mensalization"></a>
</h2>
<p>Use the microdata workflow when you need custom variable definitions,
subgroup analysis, individual-level regressions, or indicators not
available via SIDRA. This requires PNADC microdata files — see <a href="download-and-prepare.html">Download and Prepare Data</a> for how
to obtain them.</p>
<div class="section level3">
<h3 id="required-columns">Required Columns<a class="anchor" aria-label="anchor" href="#required-columns"></a>
</h3>
<p>The algorithm needs these columns from your PNADC data:</p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>Ano</code></td>
<td>Survey year</td>
</tr>
<tr class="even">
<td><code>Trimestre</code></td>
<td>Quarter (1-4)</td>
</tr>
<tr class="odd">
<td><code>UPA</code></td>
<td>Primary Sampling Unit</td>
</tr>
<tr class="even">
<td><code>V1008</code></td>
<td>Household identifier</td>
</tr>
<tr class="odd">
<td><code>V1014</code></td>
<td>Panel identifier (rotation group 1-8)</td>
</tr>
<tr class="even">
<td><code>V2008</code></td>
<td>Birth day (1-31, or 99 for unknown)</td>
</tr>
<tr class="odd">
<td><code>V20081</code></td>
<td>Birth month (1-12, or 99 for unknown)</td>
</tr>
<tr class="even">
<td><code>V20082</code></td>
<td>Birth year (or 9999 for unknown)</td>
</tr>
<tr class="odd">
<td><code>V2009</code></td>
<td>Age</td>
</tr>
</tbody>
</table>
<p>For weight calibration, you also need: <code>V1028</code> (or
<code>V1032</code> for annual data), <code>UF</code>,
<code>posest</code>, and <code>posest_sxi</code>.</p>
</div>
<div class="section level3">
<h3 id="step-1-build-the-crosswalk">Step 1: Build the Crosswalk<a class="anchor" aria-label="anchor" href="#step-1-build-the-crosswalk"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load your stacked quarterly PNADC data</span></span>
<span><span class="va">pnadc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="st">"pnadc_stacked.csv"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify reference periods (month, fortnight, week)</span></span>
<span><span class="va">crosswalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_identify_periods.html">pnadc_identify_periods</a></span><span class="op">(</span><span class="va">pnadc</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><strong>Stack multiple quarters for best results.</strong> The
algorithm exploits PNADC’s rotating panel design — each household (UPA +
V1014) is interviewed across 5 consecutive quarters at the same relative
month position. Cross-quarter aggregation achieves ~97% month
determination from the full 2012-2025 history, vs ~70% from a single
quarter.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check determination rates</span></span>
<span><span class="va">crosswalk</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  month_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">determined_month</span><span class="op">)</span>,</span>
<span>  fortnight_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">determined_fortnight</span><span class="op">)</span>,</span>
<span>  week_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">determined_week</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>See <code><a href="../reference/pnadc_identify_periods.html">?pnadc_identify_periods</a></code> for full documentation of
all crosswalk output columns.</p>
</div>
<div class="section level3">
<h3 id="step-2-apply-crosswalk-and-calibrate-weights">Step 2: Apply Crosswalk and Calibrate Weights<a class="anchor" aria-label="anchor" href="#step-2-apply-crosswalk-and-calibrate-weights"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_apply_periods.html">pnadc_apply_periods</a></span><span class="op">(</span></span>
<span>  <span class="va">pnadc_2023q1</span>,</span>
<span>  <span class="va">crosswalk</span>,</span>
<span>  weight_var <span class="op">=</span> <span class="st">"V1028"</span>,</span>
<span>  anchor <span class="op">=</span> <span class="st">"quarter"</span>,</span>
<span>  calibrate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  calibration_unit <span class="op">=</span> <span class="st">"month"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Key parameters:</strong></p>
<table class="table">
<colgroup>
<col width="39%">
<col width="28%">
<col width="32%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Values</th>
<th>Default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>weight_var</code></td>
<td>
<code>"V1028"</code> (quarterly) or <code>"V1032"</code>
(annual)</td>
<td>Required</td>
</tr>
<tr class="even">
<td><code>anchor</code></td>
<td>
<code>"quarter"</code> or <code>"year"</code>
</td>
<td>Required</td>
</tr>
<tr class="odd">
<td><code>calibrate</code></td>
<td>
<code>TRUE</code> / <code>FALSE</code>
</td>
<td><code>TRUE</code></td>
</tr>
<tr class="even">
<td><code>calibration_unit</code></td>
<td>
<code>"month"</code>, <code>"fortnight"</code>,
<code>"week"</code>
</td>
<td><code>"month"</code></td>
</tr>
<tr class="odd">
<td><code>smooth</code></td>
<td>
<code>TRUE</code> / <code>FALSE</code>
</td>
<td><code>FALSE</code></td>
</tr>
</tbody>
</table>
<p>Weight calibration adjusts survey weights to match known population
benchmarks from SIDRA, ensuring monthly totals are consistent. The
result includes all original columns plus reference period indicators
and calibrated weights (e.g., <code>weight_monthly</code>).</p>
</div>
<div class="section level3">
<h3 id="step-3-compute-monthly-estimates">Step 3: Compute Monthly Estimates<a class="anchor" aria-label="anchor" href="#step-3-compute-monthly-estimates"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Monthly unemployment rate</span></span>
<span><span class="va">monthly_unemployment</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">[</span><span class="va">determined_month</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  unemployment_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">VD4002</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span></span>
<span>                      <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">VD4001</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="va">ref_month_yyyymm</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Monthly population</span></span>
<span><span class="va">monthly_pop</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span></span>
<span>  population <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">weight_monthly</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span>, by <span class="op">=</span> <span class="va">ref_month_yyyymm</span><span class="op">]</span></span></code></pre></div>
<p>Use <code>determined_month == TRUE</code> (or equivalently,
<code>!is.na(weight_monthly)</code>) to filter to observations with
determined reference months.</p>
<p>For complete analysis examples with plots, see <a href="applied-examples.html">Applied Examples</a>.</p>
</div>
<div class="section level3">
<h3 id="build-once-apply-many">Build Once, Apply Many<a class="anchor" aria-label="anchor" href="#build-once-apply-many"></a>
</h3>
<p>The crosswalk only needs identification columns, so you can build it
once and reuse it:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build crosswalk once from stacked data</span></span>
<span><span class="va">crosswalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_identify_periods.html">pnadc_identify_periods</a></span><span class="op">(</span><span class="va">pnadc_stacked</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">crosswalk</span>, <span class="st">"crosswalk.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply to any quarterly or annual dataset</span></span>
<span><span class="va">crosswalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"crosswalk.rds"</span><span class="op">)</span></span>
<span><span class="va">result_q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_apply_periods.html">pnadc_apply_periods</a></span><span class="op">(</span><span class="va">pnadc_2023q1</span>, <span class="va">crosswalk</span>,</span>
<span>                                  weight_var <span class="op">=</span> <span class="st">"V1028"</span>, anchor <span class="op">=</span> <span class="st">"quarter"</span><span class="op">)</span></span>
<span><span class="va">result_annual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_apply_periods.html">pnadc_apply_periods</a></span><span class="op">(</span><span class="va">pnadc_annual_2023</span>, <span class="va">crosswalk</span>,</span>
<span>                                      weight_var <span class="op">=</span> <span class="st">"V1032"</span>, anchor <span class="op">=</span> <span class="st">"year"</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="monthly-series-from-sidra-no-microdata-needed">Monthly Series from SIDRA — No Microdata Needed<a class="anchor" aria-label="anchor" href="#monthly-series-from-sidra-no-microdata-needed"></a>
</h2>
<p>If you need aggregate monthly labor market statistics (unemployment
rate, employment levels, income), you can get them directly from IBGE’s
published data without any microdata. The SIDRA module converts the
rolling quarter series published by IBGE into exact monthly
estimates.</p>
<div class="section level3">
<h3 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Step 1: Fetch rolling quarter data from SIDRA API</span></span>
<span><span class="va">rolling_quarters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_sidra_rolling_quarters.html">fetch_sidra_rolling_quarters</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Convert to exact monthly estimates</span></span>
<span><span class="va">monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mensalize_sidra_series.html">mensalize_sidra_series</a></span><span class="op">(</span><span class="va">rolling_quarters</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 3: Use your monthly data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">monthly</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">anomesexato</span>, <span class="va">m_popocup</span>, <span class="va">m_taxadesocup</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/fetch_sidra_rolling_quarters.html">fetch_sidra_rolling_quarters()</a></code> downloads 70+ economic
indicators from IBGE’s SIDRA API (Tables 4093, 6390, 6392, 6399, 6906).
<code><a href="../reference/mensalize_sidra_series.html">mensalize_sidra_series()</a></code> applies the mensalization formula
using pre-computed starting points bundled with the package, converting
rolling quarter averages into exact monthly values.</p>
<p>The output contains <code>anomesexato</code> (month in YYYYMM format)
and <code>m_*</code> columns with mensalized monthly estimates, starting
from March 2012.</p>
</div>
<div class="section level3">
<h3 id="discovering-available-series">Discovering Available Series<a class="anchor" aria-label="anchor" href="#discovering-available-series"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Browse all 86+ available series</span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_sidra_series_metadata.html">get_sidra_series_metadata</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">meta</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">series_name</span>, <span class="va">description</span>, <span class="va">unit</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p><strong>Most commonly used series:</strong></p>
<table class="table">
<thead><tr class="header">
<th>Column</th>
<th>Description</th>
<th>Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>m_taxadesocup</code></td>
<td>Unemployment rate</td>
<td>Percent</td>
</tr>
<tr class="even">
<td><code>m_popocup</code></td>
<td>Employed population</td>
<td>Thousands</td>
</tr>
<tr class="odd">
<td><code>m_taxapartic</code></td>
<td>Labor force participation rate</td>
<td>Percent</td>
</tr>
<tr class="even">
<td><code>m_massahabnominaltodos</code></td>
<td>Total nominal wage bill</td>
<td>Millions R$</td>
</tr>
<tr class="odd">
<td><code>m_rendhabnominaltodos</code></td>
<td>Average nominal usual income</td>
<td>R$</td>
</tr>
<tr class="even">
<td><code>m_taxacompsubutlz</code></td>
<td>Composite underutilization rate</td>
<td>Percent</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="visualizing-monthly-vs-rolling-quarter-data">Visualizing Monthly vs Rolling Quarter Data<a class="anchor" aria-label="anchor" href="#visualizing-monthly-vs-rolling-quarter-data"></a>
</h3>
<p>Since we have both the original rolling quarter data and the
mensalized monthly estimates, comparing them is straightforward:</p>
<div class="float">
<img src="figures/getting-started/fig_monthly_vs_quarterly.png" style="width:100.0%" alt="Monthly estimates reveal dynamics hidden by rolling quarter averaging"><div class="figcaption">Monthly estimates reveal dynamics hidden by
rolling quarter averaging</div>
</div>
<details><summary>
Show plotting code
</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare comparison data (merge rolling quarter and monthly estimates)</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span></span>
<span>  <span class="va">rolling_quarters</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>anomesexato <span class="op">=</span> <span class="va">anomesfinaltrimmovel</span>, rolling <span class="op">=</span> <span class="va">taxadesocup</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  <span class="va">monthly</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">anomesexato</span>, monthly <span class="op">=</span> <span class="va">m_taxadesocup</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"anomesexato"</span></span>
<span><span class="op">)</span><span class="op">[</span><span class="va">anomesexato</span> <span class="op">&gt;=</span> <span class="fl">201901</span> <span class="op">&amp;</span> <span class="va">anomesexato</span> <span class="op">&lt;=</span> <span class="fl">202312</span><span class="op">]</span></span>
<span></span>
<span><span class="va">plot_data</span><span class="op">[</span>, <span class="va">date</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">anomesexato</span>, <span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"-"</span>,</span>
<span>                                    <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">anomesexato</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>, <span class="st">"-01"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Reshape to long format</span></span>
<span><span class="va">plot_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">plot_data</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"anomesexato"</span>, <span class="st">"date"</span><span class="op">)</span>,</span>
<span>                  variable.name <span class="op">=</span> <span class="st">"type"</span>, value.name <span class="op">=</span> <span class="st">"rate"</span><span class="op">)</span></span>
<span><span class="va">plot_long</span><span class="op">[</span>, <span class="va">type</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>,</span>
<span>                           levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rolling"</span>, <span class="st">"monthly"</span><span class="op">)</span>,</span>
<span>                           labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rolling Quarter"</span>, <span class="st">"Monthly"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">rate</span>, color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"rect"</span>, xmin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-03-01"</span><span class="op">)</span>, xmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-12-31"</span><span class="op">)</span>,</span>
<span>           ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="st">"red"</span>, alpha <span class="op">=</span> <span class="fl">0.08</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rolling Quarter"</span> <span class="op">=</span> <span class="st">"#888888"</span>,</span>
<span>                                <span class="st">"Monthly"</span> <span class="op">=</span> <span class="st">"#E53935"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"6 months"</span>, date_labels <span class="op">=</span> <span class="st">"%b\n%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"%"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Unemployment Rate: Monthly vs Rolling Quarter (2019-2023)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Monthly estimates capture the true timing and magnitude of economic shocks"</span>,</span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Unemployment Rate (%)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</details><p>For the full SIDRA guide — including custom starting points,
methodology, and a COVID case study — see the <a href="sidra-mensalization.html">SIDRA Mensalization Guide</a>.</p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="improving-determination-rates">Improving Determination Rates<a class="anchor" aria-label="anchor" href="#improving-determination-rates"></a>
</h2>
<p>PNADC uses a rotating panel where each household (UPA + V1014) is
interviewed in 5 consecutive quarters, always at the same relative month
position. This means birthday constraints from <strong>any</strong>
quarter can determine the month for <strong>all</strong> quarters —
which is why stacking more data dramatically improves rates:</p>
<table class="table">
<thead><tr class="header">
<th>Data Stacked</th>
<th>Month Rate</th>
<th>Fortnight Rate</th>
<th>Week Rate</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1 quarter</td>
<td>~70%</td>
<td>~7%</td>
<td>~2%</td>
</tr>
<tr class="even">
<td>8 quarters (2 years)</td>
<td>~94%</td>
<td>~9%</td>
<td>~3%</td>
</tr>
<tr class="odd">
<td>55 quarters (full 2012-2025)</td>
<td><strong>97.0%</strong></td>
<td><strong>9.2%</strong></td>
<td><strong>3.3%</strong></td>
</tr>
</tbody>
</table>
<p>Fortnight and week rates remain low regardless of stacking because
their constraints cannot aggregate across quarters — only month benefits
from the panel design.</p>
<p>For analyses requiring higher determination, experimental strategies
make informed probabilistic assignments:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Build crosswalk with date bounds for experimental strategies</span></span>
<span><span class="va">crosswalk</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_identify_periods.html">pnadc_identify_periods</a></span><span class="op">(</span><span class="va">pnadc</span>, store_date_bounds <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply experimental strategies</span></span>
<span><span class="va">crosswalk_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_experimental_periods.html">pnadc_experimental_periods</a></span><span class="op">(</span></span>
<span>  <span class="va">crosswalk</span>,</span>
<span>  strategy <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  confidence_threshold <span class="op">=</span> <span class="fl">0.9</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With <code>strategy = "both"</code> and
<code>confidence_threshold = 0.9</code>, month determination improves to
~97.3% and fortnight to ~13.5%. See <a href="how-it-works.html">How
PNADCperiods Works</a> for details on experimental strategies and the <a href="determination-rates-benchmark.html">Determination Rates
Benchmark</a> for comprehensive results.</p>
<hr>
</div>
<div class="section level2">
<h2 id="annual-data">Annual Data<a class="anchor" aria-label="anchor" href="#annual-data"></a>
</h2>
<p>Annual PNADC data uses different weights and achieves higher
determination rates (~98% month) due to more complete panel
coverage:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_annual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pnadc_apply_periods.html">pnadc_apply_periods</a></span><span class="op">(</span></span>
<span>  <span class="va">pnadc_annual</span>,</span>
<span>  <span class="va">crosswalk</span>,</span>
<span>  weight_var <span class="op">=</span> <span class="st">"V1032"</span>,</span>
<span>  anchor <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  calibrate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  calibration_unit <span class="op">=</span> <span class="st">"month"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For poverty and income analysis using annual data, see <a href="annual-poverty-analysis.html">Monthly Poverty Analysis with Annual
PNADC Data</a>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="function-overview">Function Overview<a class="anchor" aria-label="anchor" href="#function-overview"></a>
</h2>
<table class="table">
<colgroup>
<col width="52%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Microdata Workflow</strong></td>
<td></td>
</tr>
<tr class="even">
<td><code><a href="../reference/pnadc_identify_periods.html">pnadc_identify_periods()</a></code></td>
<td>Build period crosswalk from stacked microdata</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/pnadc_apply_periods.html">pnadc_apply_periods()</a></code></td>
<td>Apply crosswalk + calibrate weights</td>
</tr>
<tr class="even">
<td><code><a href="../reference/pnadc_experimental_periods.html">pnadc_experimental_periods()</a></code></td>
<td>Experimental strategies for higher determination</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/validate_pnadc.html">validate_pnadc()</a></code></td>
<td>Check required columns before processing</td>
</tr>
<tr class="even">
<td><strong>SIDRA Mensalization</strong></td>
<td></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/fetch_sidra_rolling_quarters.html">fetch_sidra_rolling_quarters()</a></code></td>
<td>Download rolling quarter series from SIDRA API</td>
</tr>
<tr class="even">
<td><code><a href="../reference/mensalize_sidra_series.html">mensalize_sidra_series()</a></code></td>
<td>Convert rolling quarters to exact monthly estimates</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/get_sidra_series_metadata.html">get_sidra_series_metadata()</a></code></td>
<td>Browse 86+ available series with metadata</td>
</tr>
<tr class="even">
<td><code><a href="../reference/fetch_monthly_population.html">fetch_monthly_population()</a></code></td>
<td>Fetch monthly population totals</td>
</tr>
<tr class="odd">
<td><code><a href="../reference/clear_sidra_cache.html">clear_sidra_cache()</a></code></td>
<td>Clear cached API responses</td>
</tr>
<tr class="even">
<td><code><a href="../reference/compute_starting_points_from_microdata.html">compute_starting_points_from_microdata()</a></code></td>
<td>Compute custom starting points for SIDRA mensalization</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<ul>
<li>
<strong>Download data</strong>: <a href="download-and-prepare.html">Download and Prepare Data</a> —
complete workflow to download and stack quarterly microdata from
IBGE</li>
<li>
<strong>Analysis examples</strong>: <a href="applied-examples.html">Applied Examples</a> — monthly vs quarterly
labor market analysis, COVID unemployment, minimum wage validation</li>
<li>
<strong>SIDRA deep dive</strong>: <a href="sidra-mensalization.html">SIDRA Mensalization Guide</a> — full
guide to rolling quarter mensalization, custom starting points, and
methodology</li>
<li>
<strong>Annual/poverty data</strong>: <a href="annual-poverty-analysis.html">Monthly Poverty Analysis</a> —
poverty analysis using annual PNADC income data</li>
<li>
<strong>Survey design</strong>: <a href="complex-survey-design.html">Complex Survey Design</a> — working
with survey design objects and variance estimation</li>
<li>
<strong>Algorithm details</strong>: <a href="how-it-works.html">How
PNADCperiods Works</a> — complete methodology, experimental strategies,
and weight calibration</li>
<li>
<strong>Benchmarks</strong>: <a href="determination-rates-benchmark.html">Determination Rates
Benchmark</a> — comprehensive performance results across data
configurations</li>
<li>
<strong>Function reference</strong>: Browse the <a href="../reference/index.html">Reference</a> for documentation of all
exported functions</li>
</ul>
<hr>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>HECKSHER, Marcos. “Valor Impreciso por Mes Exato: Microdados e
Indicadores Mensais Baseados na Pnad Continua”. IPEA - Nota Tecnica
Disoc, n. 62. Brasilia, DF: IPEA, 2020. <a href="https://portalantigo.ipea.gov.br/portal/index.php?option=com_content&amp;view=article&amp;id=35453" class="external-link uri">https://portalantigo.ipea.gov.br/portal/index.php?option=com_content&amp;view=article&amp;id=35453</a>
</li>
<li>HECKSHER, M. “Cinco meses de perdas de empregos e simulacao de um
incentivo a contratacoes”. IPEA - Nota Tecnica Disoc, n. 87. Brasilia,
DF: IPEA, 2020.</li>
<li>HECKSHER, Marcos. “Mercado de trabalho: A queda da segunda quinzena
de marco, aprofundada em abril”. IPEA - Carta de Conjuntura, v. 47,
p. 1-6, 2020.</li>
<li>Barbosa, Rogerio J; Hecksher, Marcos. (2026). PNADCperiods: Identify
Reference Periods in Brazil’s PNADC Survey Data. R package version
v0.1.0. <a href="https://github.com/antrologos/PNADCperiods" class="external-link uri">https://github.com/antrologos/PNADCperiods</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://orcid.org/0000-0002-6796-4547" class="external-link">Rogerio Barbosa</a>, <a href="https://orcid.org/0000-0003-2992-1252" class="external-link">Marcos Hecksher</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
